<%- include('../partials/header'); %>

<div class="row">
  <%- include('../partials/sidenav'); %>

  <div class="showAssociations content">
    <div class="showAssociations__header">
      <h2>Gestion des entreprises</h4>
        <div class="showAssociations__header--right">
          <a href="/entreprises/archives/1">Entreprise suprimées</a>
          <a href="/entreprise/new"><i data-feather="plus-square"></i>Ajouter une entreprise</a>
        </div>
    </div>
    <div class="showAssociations__all">
      <div class="showAssociations__all__items">
        <% entreprises.forEach(function(entreprise) { %>
            <div class="showAssociations__all__items__item">
              <a href="/entreprise/<%=entreprise.id %>">
                <div class="showAssociations__all__items__item__top">
                  <div class="showAssociations__all__items__item__top--left">
                    <%if (entreprise.logo){%>
                      <img src="/images/uploads/<%= entreprise.logo%>" alt="photo de profil">
                    <%}
                    else {%>
                      <img src="/images/CompanyNoProfil.png" alt="photo de profil">
                    <%}%>
                  </div>
                  <div class="showAssociations__all__items__item__top--right">
                    <a href="/entreprise/edit/<%=entreprise.id %>">
                      <svg class="edit" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"/><path d="M18 2l4 4-10 10H8v-4L18 2z"/></svg>
                    </a>
                    <a class="modal-trigger" href="#modal<%=entreprise.id %>">
                      <svg class="delete" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                    </a>
                  </div>
                </div>

                  <!-- Modal Structure -->
                  <div id="modal<%=entreprise.id %>" class="modal">
                      <div class="modal-content">
                        <h4>Supprimer l'entreprise ?</h4>
                        <p>Voulez-vous vraiment supprimer l'entreprise <%= entreprise.name%> ?</p>
                      </div>
                      <div class="modal-footer">
                          <a href="archive/<%=entreprise.id%>" class="modal-action modal-close waves-effect waves-green btn-flat">OUI</a>
                          <a href="" class="modal-action modal-close waves-effect waves-green btn-flat">NON</a>
                      </div>
                    </div>

                <div class="showAssociations__all__items__item__bottom">
                  <a href="/entreprise/<%=entreprise.id %>"><p><%= entreprise.name %></p></a>
                </div>
              </a>
          </div>
        <%})%>
      </div>
    </div>
    <div class="pagination col s12">
      <% if (pages > 0) { %>
         <ul class="pagination text-center">
             <% if (current == 1) { %>
                 <li class="disabled"><a>Première</a></li>
             <% } else { %>
                 <li><a href="/users/show/1">Première</a></li>
             <% } %>
             <% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
             <% if (i !== 1) { %>
                 <li class="disabled"><a>...</a></li>
             <% } %>
             <% for (;i <= (Number(current) + 4) && i <= pages; i++) { %>
                 <% if (i == current) { %>
                     <li class="active"><a><%= i %></a></li>
                 <% } else { %>
                     <li><a href="/users/show/<%= i %>"><%= i %></a></li>
                 <% } %>
                 <% if (i == Number(current) + 4 && i < pages) { %>
                     <li class="disabled"><a>...</a></li>
                 <% } %>
             <% } %>
             <% if (current == pages) { %>
                 <li class="disabled"><a>Dernière</a></li>
             <% } else { %>
                 <li><a href="/users/show/<%= pages %>">Dernière</a></li>
             <% } %>
         </ul>
     <% } %>
 </div>

  </div>
</div>


<%- include('../partials/footer'); %>
<script type="text/javascript">
  $(document).ready(function(){
    // the "href" attribute of the modal trigger must specify the modal ID that wants to be triggered
    $('.modal').modal();
  });
</script>
